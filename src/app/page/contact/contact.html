<div class="home-bg text-light min-vh-100 d-flex align-items-center justify-content-center">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-md-8 col-lg-6">
        <div class="card bg-dark text-light border-warning shadow-lg p-4">
          <h2 class="text-warning text-center mb-4">
            üìß Cont√°ctanos
          </h2>
          <p class="text-center mb-4">
            Complete el formulario y nos pondremos en contacto con usted en un plazo de 24 horas.
          </p>

          <form [formGroup]="contactForm" (ngSubmit)="onSubmit()" novalidate>
            <!-- Nombre -->
            <div class="mb-4">
              <label for="nombre" class="form-label">Nombre completo *</label>
              <div class="input-group">
                <input
                  type="text"
                  class="form-control"
                  [ngClass]="getFieldClass(nombre)"
                  id="nombre"
                  formControlName="nombre"
                  placeholder="Ej: Juan P√©rez">
                </div>
                @if (hasError(nombre, 'required') || hasError(nombre, 'minlength') || hasError(nombre, 'pattern')) {
                  <div class="invalid-feedback">
                    {{ getErrorMessage(nombre) }}
                  </div>
                }
                @if (nombre?.valid && (nombre?.dirty || nombre?.touched)) {
                  <div class="valid-feedback">
                    ¬°Nombre v√°lido!
                  </div>
                }
              </div>

              <!-- Correo -->
              <div class="mb-4">
                <label for="correo" class="form-label">Correo electr√≥nico *</label>
                <div class="input-group">
                  <input
                    type="email"
                    class="form-control"
                    [ngClass]="getFieldClass(correo)"
                    id="correo"
                    formControlName="correo"
                    placeholder="Ej: juan@ejemplo.com">
                  </div>
                  @if (hasError(correo, 'required') || hasError(correo, 'email') || hasError(correo, 'pattern')) {
                    <div class="invalid-feedback">
                      {{ getErrorMessage(correo) }}
                    </div>
                  }
                  @if (correo?.valid && (correo?.dirty || correo?.touched)) {
                    <div class="valid-feedback">
                      ¬°Correo electr√≥nico v√°lido!
                    </div>
                  }
                </div>

                <!-- Asunto -->
                <div class="mb-4">
                  <label for="asunto" class="form-label">Asunto *</label>
                  <div class="input-group">
                    <input
                      type="text"
                      class="form-control"
                      [ngClass]="getFieldClass(asunto)"
                      id="asunto"
                      formControlName="asunto"
                      placeholder="Ej: Consulta sobre servicios">
                    </div>
                    @if (hasError(asunto, 'required') || hasError(asunto, 'minlength')) {
                      <div class="invalid-feedback">
                        {{ getErrorMessage(asunto) }}
                      </div>
                    }
                    @if (asunto?.valid && (asunto?.dirty || asunto?.touched)) {
                      <div class="valid-feedback">
                        ¬°Asunto v√°lido!
                      </div>
                    }
                  </div>

                  <!-- Mensaje -->
                  <div class="mb-4">
                    <label for="mensaje" class="form-label">Mensaje *</label>
                    <div class="input-group">
                      <textarea
                        class="form-control"
                        [ngClass]="getFieldClass(mensaje)"
                        id="mensaje"
                        formControlName="mensaje"
                        rows="5"
                      placeholder="Escribe tu mensaje aqu√≠..."></textarea>
                    </div>
                    <div class="d-flex justify-content-between mt-1">
                      @if (hasError(mensaje, 'required') || hasError(mensaje, 'minlength') || hasError(mensaje, 'maxlength')) {
                        <div class="invalid-feedback">
                          {{ getErrorMessage(mensaje) }}
                        </div>
                      }
                      <div>
                  <small [ngClass]="{
                    'text-danger': messageCount > 950,
                    'text-warning': messageCount > 800 && messageCount <= 950,
                    'text-muted': messageCount <= 800
                  }">
                          {{ messageCount }}/1000 caracteres
                        </small>
                      </div>
                    </div>
                    @if (mensaje?.valid && (mensaje?.dirty || mensaje?.touched)) {
                      <div class="valid-feedback">
                        ¬°Mensaje v√°lido!
                      </div>
                    }
                  </div>

                  <!-- Mensajes de estado -->
                  @if (submitSuccess) {
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                      ‚úÖ ¬°Mensaje enviado con √©xito! Te contactaremos en un plazo de 24 horas.
                      <button type="button" class="btn-close" (click)="submitSuccess = false" aria-label="Close"></button>
                    </div>
                  }

                  @if (submitError) {
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                      ‚ùå Hubo un error al enviar el mensaje. Por favor, int√©ntelo de nuevo m√°s tarde.
                      <button type="button" class="btn-close" (click)="submitError = false" aria-label="Close"></button>
                    </div>
                  }

                  <!-- Botones -->
                  <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                    <button type="button" class="btn btn-outline-light me-md-2" (click)="onReset()" [disabled]="isSubmitting">
                      üîÑ Limpiar
                    </button>
                    <button type="submit" class="btn btn-warning btn-lg fw-bold" [disabled]="isSubmitting || contactForm.invalid">
                      üì®
                      @if (!isSubmitting) {
                        <span>Enviar Mensaje</span>
                      }
                      @if (isSubmitting) {
                        <span>
                          <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                          Enviando...
                        </span>
                      }
                    </button>
                  </div>

                  <p class="text-muted mt-3 small text-center">
                    * Campos obligatorios
                  </p>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>